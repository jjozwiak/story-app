// initialize page variables
function getObjects(e,t,n){var r=[];for(var i in e){if(!e.hasOwnProperty(i))continue;typeof e[i]=="object"?r=r.concat(getObjects(e[i],t,n)):i==t&&e[t]==n&&r.push(e)}return r}var currentPage="page1",swipeOrder={page1:{prev:20,next:2,story:"none"},page2:{prev:1,next:3,story:0},page3:{prev:2,next:4,story:0},page4:{prev:3,next:5,story:0},page5:{prev:4,next:6,story:0},page6:{prev:5,next:7,story:1},page7:{prev:6,next:8,story:1},page8:{prev:7,next:9,story:1},page9:{prev:8,next:10,story:2},page10:{prev:9,next:11,story:2},page11:{prev:10,next:12,story:2},page12:{prev:11,next:13,story:3},page13:{prev:12,next:14,story:3},page14:{prev:13,next:15,story:4},page15:{prev:14,next:16,story:4},page16:{prev:15,next:17,story:5},page17:{prev:16,next:18,story:5},page18:{prev:17,next:19,story:5},page19:{prev:18,next:20,story:6},page20:{prev:19,next:1,story:6}},topNav=[{navlinks:[{"link-text":"Story 1 Page1",href:"#page2"},{"link-text":"Story 1 Page 2",href:"#page3"},{"link-text":"Story 1 Page 3",href:"#page4"},{"link-text":"Story 1 Page 4",href:"#page5"}]},{navlinks:[{"link-text":"Story 2 Page1",href:"#page6"},{"link-text":"Story 2 Page 2",href:"#page7"},{"link-text":"Story 2 Page 3",href:"#page8"}]},{navlinks:[{"link-text":"Story 3 Page 1",href:"#page9"},{"link-text":"Story 3 Page 2",href:"#page10"},{"link-text":"Story 3 Page 3",href:"#page11"}]},{navlinks:[{"link-text":"Story 4 Page 1",href:"#page12"},{"link-text":"Story 4 Page 2",href:"#page13"}]},{navlinks:[{"link-text":"Story 5 Page 1",href:"#page14"},{"link-text":"Story 5 Page 2",href:"#page15"}]},{navlinks:[{"link-text":"Story 6 Page 1",href:"#page16"},{"link-text":"Story 6 Page 2",href:"#page17"},{"link-text":"Story 6 Page 3",href:"#page18"}]},{navlinks:[{"link-text":"Story 7 Page 1",href:"#page19"},{"link-text":"Story 7 Page 2",href:"#page20"}]}],buildNav=function(e,t){var n=$("#nav-template").html(),r=Handlebars.compile(n);data=topNav[e];$("#nav-links-container").html(r(data));$("#main-story-links-container ul li").removeClass("active");$("#main-story-links-container ul li").eq(e).addClass("active");$("#nav-links-container ul li a").removeClass("active");$("#nav-links-container ul li a[href^='#"+t+"']").addClass("active")},callModal=function(e){if(e===!0){$("#overlay").addClass("active");$("#modal").addClass("active")}else{$("#overlay").removeClass("active");$("#modal").removeClass("active");$("#modal-content").empty()}};(function(e){var t={init:function(t){var n={callback:function(){}};t&&e.extend(n,t);e(":jqmData(role='page')").each(function(){e(this).bind("swipeleft",function(){var t=swipeOrder[currentPage].next,n=swipeOrder["page"+t].story,r="page"+t;e.mobile.changePage("#page"+t,{transition:"slide",reverse:!1});buildNav(n,r)});e(this).bind("swiperight",function(){var t=swipeOrder[currentPage].prev,n=swipeOrder["page"+t].story,r="page"+t;e.mobile.changePage("#page"+t,{transition:"slide",reverse:!0});buildNav(n,r)})})}};e.fn.initApp=function(n){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init.apply(this,arguments);e.error("Method "+n+" does not exist")}})(jQuery);$(document).ready(function(){function n(e){return e>9?e:"0"+e}$().initApp();buildNav(0,currentPage);$(this).bind("pagechange",function(){currentPage=$.mobile.activePage[0].id;currentGroup=swipeOrder[currentPage].group;currentPage=="page10"&&setInterval(function(){$("#page10 .tit-adequate").addClass("show");$("#page10 .tit-adequate-step").addClass("show");$("#page10 .button1").addClass("show")},1e3)});$("#dropdown-button").on("click",function(){var e=$(this).parent().parent(),t=swipeOrder[currentPage].story;e.hasClass("show")&&buildNav(t,currentPage);e.toggleClass("show")});$("#warning-copy").on("click",function(){var e=$(this).parent();e.hasClass("show")?e.removeClass("show"):e.addClass("show")});$("#main-story-links-container a").on("tap",function(e){e.preventDefault();var t=$(this).data("story");buildNav(t)});$("#nav-links-container").on("tap","a",function(e){e.preventDefault();$("#nav-dropdown").removeClass("show");$("#nav-links-container ul li a").removeClass("active");$(this).addClass("active");var t=$(this).attr("href"),n=t.slice(5),r=currentPage.slice(4);parseInt(r)<parseInt(n)?$.mobile.changePage(t,{transition:"slide",reverse:!1}):$.mobile.changePage(t,{transition:"slide",reverse:!0})});var e=function(){var e=null;$.ajax({async:!1,global:!1,url:"data/footerdata.json",dataType:"json",success:function(t){e=t}});return e}();$(".footer-button").on("tap",function(){var t=$(this).data("type");switch(t){case"isi":$("#modal-content").html(e.isi);break;case"pi":$("#modal-content").html(e.pi);break;case"ref":var n=getObjects(e,"page",currentPage);n.length!=0?$("#modal-content").html(n[0].ref):$("#modal-content").html("This page does not have references. Please add them or disable the references button for this page")}callModal(!0)});$(".modal-close").on("tap",function(e){e.preventDefault();callModal(!1)});var t=0;setInterval(function(){document.getElementById("seconds").innerHTML=n(++t%60);document.getElementById("minutes").innerHTML=n(parseInt(t/60,10))},1e3)});